name: Time Trigger Task
on:
  workflow_dispatch: # å…è®¸æ‰‹åŠ¨ç‚¹å‡»æŒ‰é’®è§¦å‘ï¼Œæ–¹ä¾¿æµ‹è¯•
jobs:
  run_tasks:
    runs-on: ubuntu-latest
    permissions:
      contents: write
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
      # 1. å®‰è£… Rust (ç¼–è¯‘å¿…å¤‡)
      - name: Set up Rust
        uses: dtolnay/rust-toolchain@stable
      # 2. å®‰è£… uv
      - name: Install uv
        uses: astral-sh/setup-uv@v5
      # 3. è®¾ç½® Python
      - name: Set up Python
        run: uv python install
      # 4. ä¸€é”®å®‰è£…ä¾èµ– & ç¼–è¯‘ & è¿è¡Œ
      - name: Build and Run
        env:
          DEVICE_KEYS: ${{ secrets.DEVICE_KEYS }}
        run: |
          uv sync
          uv tool install maturin
          uv run maturin develop --release
          uv run python/time_trigger_task/__init__.py
      - name: Commit and Push changes
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          commit_message: "ğŸ¤– Auto: Update task status [skip ci]"
          file_pattern: "configs/*.json"
